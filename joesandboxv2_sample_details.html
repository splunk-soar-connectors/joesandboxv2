{% extends 'widgets/widget_template.html' %}
{% load custom_template %}
{% block custom_title_prop %}
  {% if title_logo %}
    style="background-size: auto 60%; background-position: 50%; background-repeat: no-repeat; background-image: url('/app_resource/{{ title_logo }}');"
  {% endif %}
{% endblock %}
{% block title1 %}{{ title1 }}{% endblock %}
{% block title2 %}{{ title2 }}{% endblock %}
{% block custom_tools %}{% endblock %}
{% block widget_content %}
  <!-- Main Start Block -->
  <!-- File: joesandboxv2_sample_details.html
  Copyright (c) 2019-2025 Splunk Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software distributed under
the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
either express or implied. See the License for the specific language governing permissions
and limitations under the License.
-->
  <style>
    .joesandbox-report a:hover {
        text-decoration:underline;
    }


    .joesandbox-report .wf-table-vertical {
    width: initial;
    font-size: 12px;
    }

    .joesandbox-report .wf-table-vertical td{
    padding: 8px 10px;
    border: 1px solid;
    }

    .joesandbox-report .wf-table-vertical tr td:first-child {
    font-weight: bold;
    }

    .joesandbox-report .wf-table-horizontal {
        width: 100%;
        table-layout: fixed;
        border: 1px solid;
        font-size: 12px;
    }

    .joesandbox-report .wf-table-horizontal th {
        border: 1px solid;
        text-transform: uppercase;
        font-weight: normal;
        padding: 5px;
    }

    .joesandbox-report .wf-table-horizontal td {
        word-wrap: break-word;
        border: 1px solid;
        padding: 5px;
        padding-left: 4px;
    }

    .joesandbox-report .wf-h3-style {
        font-size : 20px;
        text-align : center;
    }

    .joesandbox-report .wf-h4-style {
        font-size : 16px
    }

    .joesandbox-report .collapse.in {
        display: block !important;
    }

    .joesandbox-report #dropped-files-table li, .joesandbox-report #static-file-info-table li {
        width: 100%;
        word-wrap: break-word;
    }

    .joesandbox-report .panel{
        padding: 0px;
        box-shadow: none;
    }

    .joesandbox-report .panel-title {
        font-size: 16px;
    }

    .joesandbox-report .metadata_div .panel-body{
        margin-top:  0px;
    }

    .joesandbox-report .metadata_div .panel-group {
        margin-bottom: 0px;
    }

    .joesandbox-report .nested-block-data {
        padding: 10px;
    }

  </style>
  <div class="joesandbox-report"
       style="overflow: auto;
              width: 100%;
              height: 100%;
              padding-left:10px;
              padding-right:10px">
    <!-- Main Div -->
    {% for result in results %}
      <!-- loop for each result -->
      <br>
      <!------------------- For each Result ---------------------->
      {% if not result.data %}
        <h4 class="wf-h4-style">No sample details found</h4>
      {% else %}
        {% if result.action == "get report" %}
          <!-- Displaying downloaded report details -->
          <h3 class="wf-h3-style">Downloaded Report Details</h3>
          {% if not result.data.download_report_details.report_file_name and result.data.download_report_details.vault_id %}
            <h4 class="wf-h4-style">No vault details found</h4>
          {% else %}
            <table class="wf-table-horizontal">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Report Name</th>
                  <th>Vault ID</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>
                    <a href="javascript:;"
                       onclick="context_menu(this, [{'contains': ['joesandbox task id'], 'value': '{{ result.param.id }}' }], 0, {{ container.id }}, null, false);">
                      {{ result.param.id }}
                      &nbsp;
                      <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                    </a>
                  </td>
                  <td>
                    <a href="javascript:;"
                       onclick="context_menu(this, [{'contains': ['file name'], 'value': '{{ result.data.download_report_details.report_file_name }}' }], 0, {{ container.id }}, null, false);">
                      {{ result.data.download_report_details.report_file_name }}
                      &nbsp;
                      <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                    </a>
                  </td>
                  <td>
                    <a href="javascript:;"
                       onclick="context_menu(this, [{'contains': ['vault id'], 'value': '{{ result.data.download_report_details.vault_id }}' }], 0, {{ container.id }}, null, false);">
                      {{ result.data.download_report_details.vault_id }}
                      &nbsp;
                      <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                    </a>
                  </td>
                </tr>
              </tbody>
            </table>
          {% endif %}
          <br>
          <br>
        {% elif result.action == "detonate file" %}
          <!-- Displaying status of sample submitted -->
          <h3 class="wf-h3-style">Sample Details</h3>
          {% if not result.data.sample_status %}
            <h4 class="wf-h4-style">No sample details found</h4>
          {% else %}
            <table class="wf-table-horizontal">
              <thead>
                <tr>
                  <th>Web ID</th>
                  <th>File Name</th>
                  <th>Script Name</th>
                  <th>SHA256</th>
                  <th>MD5</th>
                  <th>SHA1</th>
                  <th>Errors</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>
                    <a href="javascript:;"
                       onclick="context_menu(this, [{'contains': ['joesandbox task id'], 'value': '{{ result.data.sample_status.webid }}' }], 0, {{ container.id }}, null, false);">
                      {{ result.data.sample_status.webid }}
                      &nbsp;
                      <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                    </a>
                  </td>
                  <td>
                    <a href="javascript:;"
                       onclick="context_menu(this, [{'contains': ['file name'], 'value': '{{ result.data.sample_status.filename }}' }], 0, {{ container.id }}, null, false);">
                      {{ result.data.sample_status.filename }}
                      &nbsp;
                      <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                    </a>
                  </td>
                  <td>
                    <a href="javascript:;"
                       onclick="context_menu(this, [{'contains': ['file name'], 'value': '{{ result.data.sample_status.scriptname }}' }], 0, {{ container.id }}, null, false);">
                      {{ result.data.sample_status.scriptname }}
                      &nbsp;
                      <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                    </a>
                  </td>
                  <td>
                    <a href="javascript:;"
                       onclick="context_menu(this, [{'contains': ['sha256'], 'value': '{{ result.data.sample_status.sha256 }}' }], 0, {{ container.id }}, null, false);">
                      {{ result.data.sample_status.sha256 }}
                      &nbsp;
                      <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                    </a>
                  </td>
                  <td>
                    <a href="javascript:;"
                       onclick="context_menu(this, [{'contains': ['md5'], 'value': '{{ result.data.sample_status.md5 }}' }], 0, {{ container.id }}, null, false);">
                      {{ result.data.sample_status.md5 }}
                      &nbsp;
                      <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                    </a>
                  </td>
                  <td>
                    <a href="javascript:;"
                       onclick="context_menu(this, [{'contains': ['sha1'], 'value': '{{ result.data.sample_status.sha1 }}' }], 0, {{ container.id }}, null, false);">
                      {{ result.data.sample_status.sha1 }}
                      &nbsp;
                      <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                    </a>
                  </td>
                  <td>{{ result.data.sample_status.errors }}</td>
                  <td>{{ result.data.sample_status.status }}</td>
                </tr>
              </tbody>
            </table>
          {% endif %}
          <br>
          <br>
        {% elif result.action == "detonate url" %}
          <h3 class="wf-h3-style">Sample Details</h3>
          {% if not result.data.sample_status %}
            <h4 class="wf-h4-style">No sample details found</h4>
          {% else %}
            <table class="wf-table-horizontal">
              <thead>
                <tr>
                  <th>Web ID</th>
                  <th>URL</th>
                  <th>Script Name</th>
                  <th>Errors</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>
                    <a href="javascript:;"
                       onclick="context_menu(this, [{'contains': ['joesandbox task id'], 'value': '{{ result.data.sample_status.webid }}' }], 0, {{ container.id }}, null, false);">
                      {{ result.data.sample_status.webid }}
                      &nbsp;
                      <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                    </a>
                  </td>
                  <td>
                    <a href="javascript:;"
                       onclick="context_menu(this, [{'contains': ['url'], 'value': '{{ result.data.sample_status.url }}' }], 0, {{ container.id }}, null, false);">
                      {{ result.data.sample_status.url }}
                      &nbsp;
                      <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                    </a>
                  </td>
                  <td>
                    <a href="javascript:;"
                       onclick="context_menu(this, [{'contains': ['file name'], 'value': '{{ result.data.sample_status.scriptname }}' }], 0, {{ container.id }}, null, false);">
                      {{ result.data.sample_status.scriptname }}
                      &nbsp;
                      <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                    </a>
                  </td>
                  <td>{{ result.data.sample_status.errors }}</td>
                  <td>{{ result.data.sample_status.status }}</td>
                </tr>
              </tbody>
            </table>
          {% endif %}
          <br>
          <br>
        {% endif %}
        <!-- Displaying sample details -->
        <h3 class="wf-h3-style">Analysis Report</h3>
        {% if not result.data.sample_details %}
          <h4 class="wf-h4-style">Analysis report not found</h4>
        {% else %}
          <div class="metadata_div">
            <!-- General Information Section -->
            <div class="panel-group" id="general-information-{{ forloop.counter }}">
              <div class="panel">
                <div class="panel-heading">
                  <h4 class="panel-title">
                    <a data-toggle="collapse"
                       href="#general-information-table-{{ forloop.counter }}">General Information</a>
                  </h4>
                </div>
                <div id="general-information-table-{{ forloop.counter }}"
                     class="panel-collapse collapse"
                     data-parent="#general-information-{{ forloop.counter }}">
                  <table class="wf-table-horizontal">
                    {% if not result.data.sample_details.generalinfo %}
                      <tbody>
                        <tr>
                          <th class="wf-h5-style">No general information found</th>
                        </tr>
                      </tbody>
                    {% else %}
                      <tbody>
                        <tr>
                          <th>Joe Sandbox Version:</th>
                          <td>{{ result.data.sample_details.generalinfo.version }}</td>
                        </tr>
                        <tr>
                          <th>Analysis ID:</th>
                          <td>{{ result.data.sample_details.generalinfo.id }}</td>
                        </tr>
                        <tr>
                          <th>Start time:</th>
                          <td>{{ result.data.sample_details.generalinfo.starttime }}</td>
                        </tr>
                        <tr>
                          <th>Joe Sandbox Product:</th>
                          <td>{{ result.data.sample_details.generalinfo.product }}</td>
                        </tr>
                        <tr>
                          <th>Start date:</th>
                          <td>{{ result.data.sample_details.generalinfo.startdate }}</td>
                        </tr>
                        <tr>
                          <th>Overall analysis duration:</th>
                          <td>{{ result.data.sample_details.generalinfo.duration }}</td>
                        </tr>
                        <tr>
                          <th>Report type:</th>
                          <td>{{ result.data.sample_details.generalinfo.reporttype }}</td>
                        </tr>
                        <tr>
                          <th>Sample file name:</th>
                          <td>
                            <a href="javascript:;"
                               onclick="context_menu(this, [{'contains': ['file name'], 'value': '{{ result.data.sample_details.generalinfo.target.sample }}' }], 0, {{ container.id }}, null, false);">
                              {{ result.data.sample_details.generalinfo.target.sample }}
                              &nbsp;
                              <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                            </a>
                          </td>
                        </tr>
                        <tr>
                          <th>Cookbook file name:</th>
                          <td>
                            <a href="javascript:;"
                               onclick="context_menu(this, [{'contains': ['file name'], 'value': '{{ result.data.sample_details.generalinfo.target.cookbook }}' }], 0, {{ container.id }}, null, false);">
                              {{ result.data.sample_details.generalinfo.target.cookbook }}
                              &nbsp;
                              <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                            </a>
                          </td>
                        </tr>
                        <tr>
                          <th>Analysis system description:</th>
                          <td>{{ result.data.sample_details.generalinfo.systemdescription }}</td>
                        </tr>
                        <tr>
                          <th>Number of analysed new started processes analysed:</th>
                          <td>{{ result.data.sample_details.generalinfo.newprocesses }}</td>
                        </tr>
                        <tr>
                          <th>Number of new started drivers analysed:</th>
                          <td>{{ result.data.sample_details.generalinfo.newdrivers }}</td>
                        </tr>
                        <tr>
                          <th>Number of existing processes analysed:</th>
                          <td>{{ result.data.sample_details.generalinfo.existingprocesses }}</td>
                        </tr>
                        <tr>
                          <th>Number of existing drivers analysed:</th>
                          <td>{{ result.data.sample_details.generalinfo.existingdriver }}</td>
                        </tr>
                        <tr>
                          <th>Number of injected processes analysed:</th>
                          <td>{{ result.data.sample_details.generalinfo.existinginjectprocesses }}</td>
                        </tr>
                      </tbody>
                    {% endif %}
                  </table>
                </div>
              </div>
            </div>
            <!-- Detection Section -->
            <div class="panel-group" id="detection-{{ forloop.counter }}">
              <div class="panel">
                <div class="panel-heading">
                  <h4 class="panel-title">
                    <a data-toggle="collapse" href="#detection-table-{{ forloop.counter }}">Detection</a>
                  </h4>
                </div>
                <div id="detection-table-{{ forloop.counter }}"
                     class="panel-collapse collapse"
                     data-parent="#detection-{{ forloop.counter }}">
                  <table class="wf-table-horizontal">
                    {% if not result.data.sample_details.signaturedetections.strategy %}
                      <tbody>
                        <tr>
                          <th class="wf-h5-style">No detection found</th>
                        </tr>
                      </tbody>
                    {% else %}
                      <tbody>
                        {% for sig_detail in result.data.sample_details.signaturedetections.strategy %}
                          {% if sig_detail.detection %}
                            <tr>
                              <th>Detection:</th>
                              {% if sig_detail.detection == "MAL" %}
                                <td>Malicious</td>
                              {% elif sig_detail.detection == "SUS" %}
                                <td>Suspicious</td>
                              {% elif sig_detail.detection == "CLEAN" %}
                                <td>CLEAN</td>
                              {% else %}
                                <td>UNKNOWN</td>
                              {% endif %}
                            </tr>
                            <tr>
                              <th>Score:</th>
                              <td>{{ sig_detail.score }}</td>
                            </tr>
                            <tr>
                              <th>Range:</th>
                              <td>{{ sig_detail.minScore }}-{{ sig_detail.maxScore }}</td>
                            </tr>
                          {% endif %}
                        {% endfor %}
                      </tbody>
                    {% endif %}
                  </table>
                </div>
              </div>
            </div>
            <!-- Contacted Domains Section -->
            <div class="panel-group" id="domains-{{ forloop.counter }}">
              <div class="panel">
                <div class="panel-heading">
                  <h4 class="panel-title">
                    <a data-toggle="collapse" href="#domains-table-{{ forloop.counter }}">Contacted Domains</a>
                  </h4>
                </div>
                <div id="domains-table-{{ forloop.counter }}"
                     class="panel-collapse collapse"
                     data-parent="#domains-{{ forloop.counter }}">
                  <table class="wf-table-horizontal">
                    {% if not result.data.sample_details.domaininfo.domain %}
                      <tbody>
                        <tr>
                          <th class="wf-h5-style">No contacted domains info</th>
                        </tr>
                      </tbody>
                    {% else %}
                      <thead>
                        <tr>
                          <th>Name</th>
                          <th>IP</th>
                          <th>Active</th>
                        </tr>
                      </thead>
                      <tbody>
                        {% for domain_info in result.data.sample_details.domaininfo.domain %}
                          <tr>
                            <td>
                              <a href="javascript:;"
                                 onclick="context_menu(this, [{'contains': ['domain'], 'value': '{{ domain_info|by_key:'@name' }}' }], 0, {{ container.id }}, null, false);">
                                {{ domain_info|by_key:"@name" }}
                                &nbsp;
                                <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                              </a>
                            </td>
                            <td>
                              <a href="javascript:;"
                                 onclick="context_menu(this, [{'contains': ['ip'], 'value': '{{ domain_info|by_key:'@ip' }}' }], 0, {{ container.id }}, null, false);">
                                {{ domain_info|by_key:"@ip" }}
                                &nbsp;
                                <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                              </a>
                            </td>
                            <td>{{ domain_info|by_key:"@active" }}</td>
                          </tr>
                        {% endfor %}
                      </tbody>
                    {% endif %}
                  </table>
                </div>
              </div>
            </div>
            <!-- Contacted IPs Sections -->
            <div class="panel-group" id="ip-{{ forloop.counter }}">
              <div class="panel">
                <div class="panel-heading">
                  <h4 class="panel-title">
                    <a data-toggle="collapse" href="#ip-table-{{ forloop.counter }}">Contacted IPs</a>
                  </h4>
                </div>
                <div id="ip-table-{{ forloop.counter }}"
                     class="panel-collapse collapse"
                     data-parent="#ip-{{ forloop.counter }}">
                  <table class="wf-table-horizontal">
                    {% if not result.data.sample_details.ipinfo.ip %}
                      <tbody>
                        <tr>
                          <th class="wf-h5-style">No contacted IP infos</th>
                        </tr>
                      </tbody>
                    {% else %}
                      <thead>
                        <tr>
                          <th>IP</th>
                          <th>Country</th>
                          <th>ASN</th>
                          <th>ASN Name</th>
                        </tr>
                      </thead>
                      <tbody>
                        {% for ip_info in result.data.sample_details.ipinfo.ip %}
                          <tr>
                            <td>
                              <a href="javascript:;"
                                 onclick="context_menu(this, [{'contains': ['ip'], 'value': '{{ ip_info|by_key:'@ip' }}' }], 0, {{ container.id }}, null, false);">
                                {{ ip_info|by_key:"@ip" }}
                                &nbsp;
                                <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                              </a>
                            </td>
                            <td>{{ ip_info|by_key:"@country" }}</td>
                            <td>{{ ip_info|by_key:"@asnnbr" }}</td>
                            <td>{{ ip_info|by_key:"@asnname" }}</td>
                          </tr>
                        {% endfor %}
                      </tbody>
                    {% endif %}
                  </table>
                </div>
              </div>
            </div>
            <!-- Static File Info Section -->
            <div class="panel-group" id="static-file-info-{{ forloop.counter }}">
              <div class="panel">
                <div class="panel-heading">
                  <h4 class="panel-title">
                    <a data-toggle="collapse"
                       href="#static-file-info-data-{{ forloop.counter }}">Static File Info</a>
                  </h4>
                </div>
                <div id="static-file-info-data-{{ forloop.counter }}"
                     class="panel-collapse collapse"
                     data-parent="#static-file-info-{{ forloop.counter }}">
                  <table class="wf-table-horizontal" id="static-file-info-table">
                    {% if not result.data.sample_details.fileinfo %}
                      <tbody>
                        <tr>
                          <th class="wf-h5-style">No static file info</th>
                        </tr>
                      </tbody>
                    {% else %}
                      <tbody>
                        <tr>
                          <th>File Type:</th>
                          <td>{{ result.data.sample_details.fileinfo.filetype }}</td>
                        </tr>
                        <tr>
                          <th>TrID:</th>
                          <td>
                            <ul>
                              {% for trid_info in result.data.sample_details.fileinfo.trid.def %}<li>{{ trid_info }}</li>{% endfor %}
                            </ul>
                          </td>
                        </tr>
                        <tr>
                          <th>File name:</th>
                          <td>
                            <a href="javascript:;"
                               onclick="context_menu(this, [{'contains': ['file name'], 'value': '{{ result.data.sample_details.fileinfo.filename }}' }], 0, {{ container.id }}, null, false);">
                              {{ result.data.sample_details.fileinfo.filename }}
                              &nbsp;
                              <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                            </a>
                          </td>
                        </tr>
                        <tr>
                          <th>File size:</th>
                          <td>{{ result.data.sample_details.fileinfo.filesize }}</td>
                        </tr>
                        <tr>
                          <th>MD5:</th>
                          <td>
                            <a href="javascript:;"
                               onclick="context_menu(this, [{'contains': ['md5'], 'value': '{{ result.data.sample_details.fileinfo.md5 }}' }], 0, {{ container.id }}, null, false);">
                              {{ result.data.sample_details.fileinfo.md5 }}
                              &nbsp;
                              <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                            </a>
                          </td>
                        </tr>
                        <tr>
                          <th>SHA1:</th>
                          <td>
                            <a href="javascript:;"
                               onclick="context_menu(this, [{'contains': ['sha1'], 'value': '{{ result.data.sample_details.fileinfo.sha1 }}' }], 0, {{ container.id }}, null, false);">
                              {{ result.data.sample_details.fileinfo.sha1 }}
                              &nbsp;
                              <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                            </a>
                          </td>
                        </tr>
                        <tr>
                          <th>SHA256:</th>
                          <td>
                            <a href="javascript:;"
                               onclick="context_menu(this, [{'contains': ['sha256'], 'value': '{{ result.data.sample_details.fileinfo.sha256 }}' }], 0, {{ container.id }}, null, false);">
                              {{ result.data.sample_details.fileinfo.sha256 }}
                              &nbsp;
                              <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                            </a>
                          </td>
                        </tr>
                        <tr>
                          <th>SHA512:</th>
                          <td>{{ result.data.sample_details.fileinfo.sha512 }}</td>
                        </tr>
                        <tr>
                          <th>File Content Preview:</th>
                          <td>{{ result.data.sample_details.fileinfo.preview }}</td>
                        </tr>
                      </tbody>
                    {% endif %}
                  </table>
                </div>
              </div>
            </div>
            <!-- Created / Dropped Files Section -->
            <div class="panel-group" id="dropped-files-{{ forloop.counter }}">
              <div class="panel">
                <div class="panel-heading">
                  <h4 class="panel-title">
                    <a data-toggle="collapse"
                       href="#dropped-files-data-{{ forloop.counter }}">Created / Dropped Files</a>
                  </h4>
                </div>
                <div id="dropped-files-data-{{ forloop.counter }}"
                     class="panel-collapse collapse"
                     data-parent="#dropped-files-{{ forloop.counter }}">
                  <table class="wf-table-horizontal" id="dropped-files-table">
                    {% if not result.data.sample_details.droppedinfo.hash %}
                      <tbody>
                        <tr>
                          <th class="wf-h5-style">No created / dropped files found</th>
                        </tr>
                      </tbody>
                    {% else %}
                      <thead>
                        <tr>
                          <th>File Path</th>
                          <th>Types and Hashes</th>
                        </tr>
                      </thead>
                      <tbody>
                        {% for dropped_info in result.data.sample_details.droppedinfo.hash %}
                          <tr>
                            <td>
                              <a href="javascript:;"
                                 onclick="context_menu(this, [{'contains': ['file path'], 'value': '{{ dropped_info|by_key:'@file' }}' }], 0, {{ container.id }}, null, false);">
                                {{ dropped_info|by_key:"@file" }}
                                &nbsp;
                                <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                              </a>
                            </td>
                            <td>
                              <ul>
                                <li>Type: {{ dropped_info|by_key:"@type" }}</li>
                                {% for hash in dropped_info.value %}
                                  {% if hash|by_key:"@algo" == "SHA-512" %}
                                    <li>SHA512: {{ hash|by_key:"$" }}</li>
                                  {% elif hash|by_key:"@algo" == "MD5" %}
                                    <li>
                                      MD5: <a href="javascript:;"
    onclick="context_menu(this, [{'contains': ['md5'], 'value': '{{ hash|by_key:'$' }}' }], 0, {{ container.id }}, null, false);">
                                      {{ hash|by_key:"$" }}
                                      &nbsp;
                                      <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                    </a>
                                  </li>
                                {% elif hash|by_key:"@algo" == "SHA" %}
                                  <li>
                                    SHA1: <a href="javascript:;"
    onclick="context_menu(this, [{'contains': ['sha1'], 'value': '{{ hash|by_key:'$' }}' }], 0, {{ container.id }}, null, false);">
                                    {{ hash|by_key:"$" }}
                                    &nbsp;
                                    <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                  </a>
                                </li>
                              {% elif hash|by_key:"@algo" == "SHA-256" %}
                                <li>
                                  SHA256: <a href="javascript:;"
    onclick="context_menu(this, [{'contains': ['sha256'], 'value': '{{ hash|by_key:'$' }}' }], 0, {{ container.id }}, null, false);">
                                  {{ hash|by_key:"$" }}
                                  &nbsp;
                                  <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                </a>
                              </li>
                            {% endif %}
                          {% endfor %}
                        </ul>
                      </td>
                    </tr>
                  {% endfor %}
                </tbody>
              {% endif %}
            </table>
          </div>
        </div>
      </div>
      <!-- System Behavior Section -->
      <div class="panel-group" id="system-behavior-{{ forloop.counter }}">
        <div class="panel">
          <div class="panel-heading">
            <h4 class="panel-title">
              <a data-toggle="collapse"
                 href="#system-behavior-data-{{ forloop.counter }}">System Behavior</a>
            </h4>
          </div>
          <div id="system-behavior-data-{{ forloop.counter }}"
               class="panel-collapse collapse nested-block-data"
               data-parent="#system-behavior-{{ forloop.counter }}">
            {% if not result.data.sample_details.system_behavior %}
              <table class="wf-table-horizontal" id="system-behavior-table">
                <tbody>
                  <tr>
                    <th class="wf-h5-style">No system behavior found</th>
                  </tr>
                </tbody>
              </table>
            {% else %}
              {% for module_data in result.data.sample_details.system_behavior %}
                <!-- Data of each module -->
                <div class="panel-group" id={{ module_data.div_parent_id }}>
                  <div class="panel">
                    <div class="panel-heading">
                      <h4 class="panel-title">
                        <a data-toggle="collapse"
                           data-parent="{{ module_data.div_parent_id }}"
                           href="{{ module_data.href_child_id }}">Analysis Process: {{ module_data.general.name }} PID: {{ module_data.general.pid }} Parent PID: {{ module_data.general.parentpid }}</a>
                      </h4>
                    </div>
                    <div id="{{ module_data.div_child_id }}"
                         class="panel-collapse collapse show nested-block-data">
                      <!--Module general information section-->
                      <div class="panel-group module-general-info"
                           id="general-info-section-{{ forloop.counter0 }}">
                        <div class="panel">
                          <div class="panel-heading">
                            <h4 class="panel-title">
                              <a data-toggle="collapse"
                                 data-parent="#general-info-section-{{ forloop.counter0 }}"
                                 href="#general-info-section-{{ forloop.counter0 }}-data">General</a>
                            </h4>
                          </div>
                          <div id="general-info-section-{{ forloop.counter0 }}-data"
                               class="panel-collapse collapse in">
                            {% if not "general" in module_data %}
                              <table class="wf-table-horizontal">
                                <thead>
                                  <tr>
                                    <th class="wf-h5-style" colspan="2">No general Information found</th>
                                  </tr>
                                </thead>
                              </table>
                            {% else %}
                              <table class="wf-table-horizontal">
                                <tbody>
                                  <tr>
                                    <th>Start time:</th>
                                    <td>{{ module_data.general.time }}</td>
                                  </tr>
                                  <tr>
                                    <th>Start date:</th>
                                    <td>{{ module_data.general.date }}</td>
                                  </tr>
                                  <tr>
                                    <th>Path:</th>
                                    <td>
                                      <a href="javascript:;"
                                         onclick="context_menu(this, [{'contains': ['file path'], 'value': '{{ module_data.general.path }}' }], 0, {{ container.id }}, null, false);">
                                        {{ module_data.general.path }}
                                        &nbsp;
                                        <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                      </a>
                                    </td>
                                  </tr>
                                  <tr>
                                    <th>Wow64 process (32bit):</th>
                                    <td>{{ module_data.general.wow64 }}</td>
                                  </tr>
                                  <tr>
                                    <th>Commandline:</th>
                                    <td>{{ module_data.general.cmdline }}</td>
                                  </tr>
                                  <tr>
                                    <th>Imagebase:</th>
                                    <td>{{ module_data.general.modulebase }}</td>
                                  </tr>
                                  <tr>
                                    <th>File size:</th>
                                    <td>{{ module_data.general.size }} bytes</td>
                                  </tr>
                                  <tr>
                                    <th>MD5 Hash:</th>
                                    <td>
                                      <a href="javascript:;"
                                         onclick="context_menu(this, [{'contains': ['md5'], 'value': '{{ module_data.general.md5 }}' }], 0, {{ container.id }}, null, false);">
                                        {{ module_data.general.md5 }}
                                        &nbsp;
                                        <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                      </a>
                                    </td>
                                  </tr>
                                </tbody>
                              </table>
                            {% endif %}
                          </div>
                        </div>
                      </div>
                      <!--Module file activities section-->
                      <div class="panel-group"
                           id="file-activities-section-{{ forloop.counter0 }}">
                        <div class="panel">
                          <div class="panel-heading">
                            <h4 class="panel-title">
                              <a data-toggle="collapse"
                                 href="#file-activities-section-{{ forloop.counter0 }}-data">File Activities</a>
                            </h4>
                          </div>
                          <div id="file-activities-section-{{ forloop.counter0 }}-data"
                               class="panel-collapse collapse nested-block-data"
                               data-parent="#file-activities-section-{{ forloop.counter0 }}">
                            <!--Files Deleted Section-->
                            <div class="panel-group" id="file-deleted-section-{{ forloop.counter0 }}">
                              <div class="panel">
                                <div class="panel-heading">
                                  <h4 class="panel-title">
                                    <a data-toggle="collapse"
                                       href="#file-deleted-section-{{ forloop.counter0 }}-data">File Deleted</a>
                                  </h4>
                                </div>
                                <div id="file-deleted-section-{{ forloop.counter0 }}-data"
                                     class="panel-collapse collapse"
                                     data-parent="#file-deleted-section-{{ forloop.counter0 }}">
                                  {% if not "fileDeleted" in module_data.fileactivities %}
                                    <table class="wf-table-horizontal">
                                      <thead>
                                        <tr>
                                          <th class="wf-h5-style" colspan="5">No file deletion activities found</th>
                                        </tr>
                                      </thead>
                                    </table>
                                  {% else %}
                                    <table class="wf-table-horizontal">
                                      <thead>
                                        <tr>
                                          <th>File Path</th>
                                          <th>Completion</th>
                                          <th>Count</th>
                                          <th>Source Address</th>
                                          <th>Symbol</th>
                                        </tr>
                                      </thead>
                                      <tbody>
                                        {% for file_data in module_data.fileactivities.fileDeleted %}
                                          <tr>
                                            <td>
                                              <a href="javascript:;"
                                                 onclick="context_menu(this, [{'contains': ['file path'], 'value': '{{ file_data.path }}' }], 0, {{ container.id }}, null, false);">
                                                {{ file_data.path }}
                                                &nbsp;
                                                <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                              </a>
                                            </td>
                                            <td>{{ file_data.status }}</td>
                                            <td>{{ file_data.count }}</td>
                                            <td>{{ file_data.ret }}</td>
                                            <td>{{ file_data.symbol }}</td>
                                          </tr>
                                        {% endfor %}
                                      </tbody>
                                    </table>
                                  {% endif %}
                                </div>
                              </div>
                            </div>
                            <!--Files Moved Section-->
                            <div class="panel-group" id="file-moved-section-{{ forloop.counter0 }}">
                              <div class="panel">
                                <div class="panel-heading">
                                  <h4 class="panel-title">
                                    <a data-toggle="collapse"
                                       href="#file-moved-section-{{ forloop.counter0 }}-data">File Moved</a>
                                  </h4>
                                </div>
                                <div id="file-moved-section-{{ forloop.counter0 }}-data"
                                     class="panel-collapse collapse"
                                     data-parent="#file-moved-section-{{ forloop.counter0 }}">
                                  {% if not "fileMoved" in module_data.fileactivities %}
                                    <table class="wf-table-horizontal">
                                      <thead>
                                        <tr>
                                          <th class="wf-h5-style" colspan="6">No file repositioning activities found</th>
                                        </tr>
                                      </thead>
                                    </table>
                                  {% else %}
                                    <table class="wf-table-horizontal">
                                      <thead>
                                        <tr>
                                          <th>Old File Path</th>
                                          <th>New File Path</th>
                                          <th>Completion</th>
                                          <th>Count</th>
                                          <th>Source Address</th>
                                          <th>Symbol</th>
                                        </tr>
                                      </thead>
                                      <tbody>
                                        {% for file_data in module_data.fileactivities.fileMoved %}
                                          <tr>
                                            <td>
                                              <a href="javascript:;"
                                                 onclick="context_menu(this, [{'contains': ['file path'], 'value': '{{ file_data.path }}' }], 0, {{ container.id }}, null, false);">
                                                {{ file_data.path }}
                                                &nbsp;
                                                <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                              </a>
                                            </td>
                                            <td>
                                              <a href="javascript:;"
                                                 onclick="context_menu(this, [{'contains': ['file path'], 'value': '{{ file_data.newpath }}' }], 0, {{ container.id }}, null, false);">
                                                {{ file_data.newpath }}
                                                &nbsp;
                                                <span class="fa fa-caret-down" style="font-size: smaller;"></span>
                                              </a>
                                            </td>
                                            <td>{{ file_data.status }}</td>
                                            <td>{{ file_data.count }}</td>
                                            <td>{{ file_data.ret }}</td>
                                            <td>{{ file_data.symbol }}</td>
                                          </tr>
                                        {% endfor %}
                                      </tbody>
                                    </table>
                                  {% endif %}
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!--Module registry activities section-->
                      <div class="panel-group"
                           id="registry-activities-section-{{ forloop.counter0 }}">
                        <div class="panel">
                          <div class="panel-heading">
                            <h4 class="panel-title">
                              <a data-toggle="collapse"
                                 href="#registry-activities-section-{{ forloop.counter0 }}-data">Registry Activities</a>
                            </h4>
                          </div>
                          <div id="registry-activities-section-{{ forloop.counter0 }}-data"
                               class="panel-collapse collapse nested-block-data"
                               data-parent="#registry-activities-section-{{ forloop.counter0 }}">
                            <!--Keys Created Section-->
                            <div class="panel-group" id="key-created-section-{{ forloop.counter0 }}">
                              <div class="panel">
                                <div class="panel-heading">
                                  <h4 class="panel-title">
                                    <a data-toggle="collapse"
                                       href="#key-created-section-{{ forloop.counter0 }}-data">Key Created</a>
                                  </h4>
                                </div>
                                <div id="key-created-section-{{ forloop.counter0 }}-data"
                                     class="panel-collapse collapse"
                                     data-parent="#key-created-section-{{ forloop.counter0 }}">
                                  {% if not "keyCreated" in module_data.registryactivities %}
                                    <table class="wf-table-horizontal">
                                      <thead>
                                        <tr>
                                          <th class="wf-h5-style" colspan="5">No keys created</th>
                                        </tr>
                                      </thead>
                                    </table>
                                  {% else %}
                                    <table class="wf-table-horizontal">
                                      <thead>
                                        <tr>
                                          <th>Key Path</th>
                                          <th>Completion</th>
                                          <th>Count</th>
                                          <th>Source Address</th>
                                          <th>Symbol</th>
                                        </tr>
                                      </thead>
                                      <tbody>
                                        {% for key_details in module_data.registryactivities.keyCreated %}
                                          <tr>
                                            <td>{{ key_details.path }}</td>
                                            <td>{{ key_details.status }}</td>
                                            <td>{{ key_details.count }}</td>
                                            <td>{{ key_details.ret }}</td>
                                            <td>{{ key_details.symbol }}</td>
                                          </tr>
                                        {% endfor %}
                                      </tbody>
                                    </table>
                                  {% endif %}
                                </div>
                              </div>
                            </div>
                            <!--Keys Deleted Section-->
                            <div class="panel-group" id="key-deleted-section-{{ forloop.counter0 }}">
                              <div class="panel">
                                <div class="panel-heading">
                                  <h4 class="panel-title">
                                    <a data-toggle="collapse"
                                       href="#key-deleted-section-{{ forloop.counter0 }}-data">Key Deleted</a>
                                  </h4>
                                </div>
                                <div id="key-deleted-section-{{ forloop.counter0 }}-data"
                                     class="panel-collapse collapse"
                                     data-parent="#key-deleted-section-{{ forloop.counter0 }}">
                                  {% if not "keyDeleted" in module_data.registryactivities %}
                                    <table class="wf-table-horizontal">
                                      <thead>
                                        <tr>
                                          <th class="wf-h5-style" colspan="5">No keys deleted</th>
                                        </tr>
                                      </thead>
                                    </table>
                                  {% else %}
                                    <table class="wf-table-horizontal">
                                      <thead>
                                        <tr>
                                          <th>Key Path</th>
                                          <th>Completion</th>
                                          <th>Count</th>
                                          <th>Source Address</th>
                                          <th>Symbol</th>
                                        </tr>
                                      </thead>
                                      <tbody>
                                        {% for key_details in module_data.registryactivities.keyDeleted %}
                                          <tr>
                                            <td>{{ key_details.path }}</td>
                                            <td>{{ key_details.status }}</td>
                                            <td>{{ key_details.count }}</td>
                                            <td>{{ key_details.ret }}</td>
                                            <td>{{ key_details.symbol }}</td>
                                          </tr>
                                        {% endfor %}
                                      </tbody>
                                    </table>
                                  {% endif %}
                                </div>
                              </div>
                            </div>
                            <!--Key Value Modified Section-->
                            <div class="panel-group" id="key-modified-section-{{ forloop.counter0 }}">
                              <div class="panel">
                                <div class="panel-heading">
                                  <h4 class="panel-title">
                                    <a data-toggle="collapse"
                                       href="#key-modified-section-{{ forloop.counter0 }}-data">Key Value Modified</a>
                                  </h4>
                                </div>
                                <div id="key-modified-section-{{ forloop.counter0 }}-data"
                                     class="panel-collapse collapse"
                                     data-parent="#key-modified-section-{{ forloop.counter0 }}">
                                  {% if not "keyValueModified" in module_data.registryactivities %}
                                    <table class="wf-table-horizontal">
                                      <thead>
                                        <tr>
                                          <th class="wf-h5-style" colspan="9">No keys modified</th>
                                        </tr>
                                      </thead>
                                    </table>
                                  {% else %}
                                    <table class="wf-table-horizontal">
                                      <thead>
                                        <tr>
                                          <th>Key Path</th>
                                          <th>Name</th>
                                          <th>Type</th>
                                          <th>Old Data</th>
                                          <th>New Data</th>
                                          <th>Completion</th>
                                          <th>Count</th>
                                          <th>Source Address</th>
                                          <th>Symbol</th>
                                        </tr>
                                      </thead>
                                      <tbody>
                                        {% for key_details in module_data.registryactivities.keyValueModified %}
                                          <tr>
                                            <td>{{ key_details.path }}</td>
                                            <td>{{ key_details.name }}</td>
                                            <td>{{ key_details.type }}</td>
                                            <td>{{ key_details.olddata }}</td>
                                            <td>{{ key_details.newdata }}</td>
                                            <td>{{ key_details.status }}</td>
                                            <td>{{ key_details.count }}</td>
                                            <td>{{ key_details.ret }}</td>
                                            <td>{{ key_details.symbol }}</td>
                                          </tr>
                                        {% endfor %}
                                      </tbody>
                                    </table>
                                  {% endif %}
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              {% endfor %}
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  {% endif %}
  <br>
{% endif %}
{% endfor %}
</div>
<!-- Main Div -->
<script>
    $.extend(true, $.fn.dataTable.defaults, {
        "searching": false,
        "bLengthChange": false,
        "language": {
            "paginate": {
                "previous": "<i class='fa fa-angle-left fa-lg'></i>",
                "next": "<i class='fa fa-angle-right fa-lg'></i>"
            }
        },
        "dom": '<"top">rt<"bottom"p><"clear">',
        drawCallback: function(settings) {
            var pagination = $(this).closest('.dataTables_wrapper').find('.dataTables_paginate');
            pagination.toggle(this.api().page.info().pages > 1);
        }
    });
    $.fn.DataTable.ext.pager.numbers_length = 5;
    $('.datatable').DataTable();
</script>
{% endblock %}
<!-- Main Start Block -->
